<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>프로젝트 허브 — 시(물리)에이션</title>

  <!-- 기존 <style> 안에 있던 CSS는 전부 styles.css로 옮기고 여기서 링크 -->
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="wrap">
    <header>
      <h1>
        <span style="display:inline-flex;width:28px;height:28px;border-radius:8px;align-items:center;justify-content:center;background:#16234d;border:1px solid #2d3a66">⚛️</span>
        <span class="logo-text">시(물리)에이션</span>
        <span class="pill" title="총 프로젝트 수"><span id="count">0</span>개</span>
      </h1>

      <div class="top-right-wrap">
        <div class="controls">
          <input id="q" type="search" placeholder="검색: 제목·태그" />
          <select id="cat">
            <option value="">모든 분류</option>
            <option>시뮬레이션</option>
            <option>전자/반도체</option>
            <option>광학</option>
            <option>상대성</option>
            <option>데이터도구</option>
            <option>웹앱</option>
            <option>열</option>
            <option>역학</option>
          </select>
          <select id="sort">
            <option value="updated">최신순</option>
            <option value="title">가나다순</option>
            <option value="category">분류순</option>
          </select>
        </div>

        <!-- 상단 우측 로그인 바 -->
        <div class="auth-bar" id="auth-bar">
          <span id="status">로그인 상태: 없음</span>
          <button class="auth-btn" id="open-auth" type="button">로그인</button>
          <button class="auth-btn outline" type="button" onclick="location.href='./admin.html'">관리자 모드</button>
          <button class="auth-btn outline" id="logout-btn" onclick="logout()" style="display:none;">로그아웃</button>
        </div>
      </div>
    </header>

    <!-- 로그인 / 비밀번호 / 내 정보 패널 -->
    <div id="auth-panel" class="auth-panel" aria-hidden="true">
 <h3 style="display:flex; justify-content:space-between; align-items:center;">
  로그인 / 비밀번호
  <button type="button" class="auth-link" id="top-change-btn" onclick="openChangeMode()">비밀번호 변경</button>
</h3>

      <!-- 로그인 후 표시되는 정보 섹션 -->
      <div id="info-section" class="auth-section" style="display:none;">
        <div class="info-id" id="info-id-label">아이디: -</div>
        <div class="info-score-label">현재 점수</div>
        <div class="info-score-big" id="info-score-big">0점</div>
<div id="rank-img-wrap" style="text-align:center; margin-top:8px;">
  <img id="rank-img" src="" style="width:80px; height:80px; object-fit:contain;">
</div>
        <button type="button" class="auth-link" onclick="openChangeMode()">비밀번호 변경</button>
      </div>

      <!-- 로그인 섹션 -->
      <div id="login-section" class="auth-section">
        <input type="text" id="loginId" placeholder="아이디 (선생님이 준 ID)" />
        <input type="password" id="loginPassword" placeholder="비밀번호" />
        <button type="button" onclick="login()">로그인</button>
        <button type="button" class="auth-link" onclick="openChangeMode()">비밀번호 변경</button>
      </div>

      <!-- 비밀번호 변경 섹션 -->
      <div id="change-section" class="auth-section" style="display:none;">
        <input type="text" id="changeId" placeholder="아이디 (현재 로그인한 ID)" />
        <input type="password" id="changeCurrentPassword" placeholder="현재 비밀번호" />
        <input type="password" id="changeNewPassword" placeholder="새 비밀번호 (6자 이상)" />
        <div style="display:flex;gap:6px;justify-content:flex-end;">
          <button type="button" class="auth-btn outline small" onclick="closeChangeMode()">취소</button>
          <button type="button" onclick="changePassword()">비밀번호 변경</button>
        </div>
      </div>

      <p id="pw-status" class="auth-status"></p>

      <div class="auth-close-row">
        <button type="button" class="auth-close">닫기</button>
      </div>
    </div>

    <div class="divider"></div>

    <section class="ph-card" id="fun-fact" aria-live="polite">
      <div class="ph-inner">
        <span class="ph-badge">📎</span>
        <div style="flex:1 1 auto">
          <h2 class="ph-title">오늘의 물리</h2>
          <div class="ph-fact" id="fact-text">로딩 중…</div>
        </div>
        <div class="ph-actions">
          <button class="ph-btn primary" id="next-fact">다른 사실</button>
          <button class="ph-btn" id="copy-fact" title="클립보드로 복사">복사</button>
        </div>
      </div>
    </section>

    <section class="ph-canvas-wrap" aria-label="인터랙티브 중력 배경">
      <canvas id="gravity-bg"></canvas>
      <div class="ph-controls">
        <button class="ph-btn" id="toggle-run">⏸︎ 일시정지</button>
        <button class="ph-btn" id="toggle-trail">트레일: 켜짐</button>
        <button class="ph-btn" id="reset">리셋</button>
        <div class="ph-slider">
          <label for="particle-count">파티클</label>
          <input type="range" id="particle-count" min="50" max="800" step="10" value="260" />
          <span id="particle-label">260</span>
        </div>
      </div>
    </section>

    <main id="grid" class="grid" aria-live="polite"></main>

    <template id="card-tpl">
      <article class="card" tabindex="0" aria-label="프로젝트 카드">
        <div class="thumb"><span>🧪</span></div>
        <div class="body">
          <div class="title"><h3></h3></div>
          <p class="desc"></p>
          <div class="curriculum"></div>
          <div class="tags"></div>
          <div class="meta"><span class="category"></span><span class="date"></span></div>
          <div class="actions">
            <a class="demo" target="_blank" rel="noopener">미리보기</a>
          </div>
        </div>
      </article>
    </template>

    <p class="empty" id="empty" style="display:none">검색 조건에 맞는 프로젝트가 없습니다.</p>

    <div class="footer-admin">
      <a href="./admin.html" style="font-size:11px;opacity:0.25;">관리자</a>
    </div>
  </div>

  <!-- 일반 JS (DOM, 카드, 중력, 오늘의 물리, 패널 UI) -->
  <script src="main.js"></script>

  <!-- Firebase (module) -->
  <script type="module" src="firebase-auth.js"></script>
</body>
</html>
