<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>í”„ë¡œì íŠ¸ í—ˆë¸Œ â€” ì‹œ(ë¬¼ë¦¬)ì—ì´ì…˜</title>
  <style>
    :root{
      --bg:#0b1020; --panel:#121a33; --ink:#e9efff; --muted:#a6b3d9; --line:#243166; --accent:#7aa2ff;
      --good:#10b981; --warn:#f59e0b; --bad:#ef4444; --radius:18px; --shadow:0 10px 28px rgba(9,12,28,.28);
      --ph-card:#0d1530; --ph-border:#2a3a72; --ph-accent:#4da3ff; --ph-green:#6be675;
      --bg-size: contain; /* cover | contain */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      color:var(--ink);
      font:14px/1.55 ui-sans-serif,system-ui,"Pretendard","Noto Sans KR","Apple SD Gothic Neo",Arial;

      /* ë‘ ë ˆì´ì–´ ëª¨ë‘ ê³ ì •(fixed) + ì´ë¯¸ì§€ ì „ì²´ ë³´ì´ë„ë¡ contain */
      background-image:
        radial-gradient(1200px 800px at 10% -10%, rgba(14,23,53,0.62) 0%, rgba(11,16,32,0.74) 60%),
        url("./space-bg.jpg?v=1");
      background-position: center center, center center;
      background-size: cover;
      background-repeat: no-repeat, no-repeat;
      background-attachment: fixed, fixed;

      /* ì´ë¯¸ì§€ ë¹„ì–´ ë³´ì´ëŠ” ê°€ì¥ìë¦¬ ìƒ‰( contain ì‚¬ìš© ì‹œ ) */
      background-color: #0b1020;
      min-height:100dvh;
    }

    .wrap{max-width:1200px;margin:0 auto;padding:22px 16px 48px;position:relative}
    header{display:flex;flex-wrap:wrap;gap:12px;align-items:center;justify-content:space-between;position:relative;z-index:2}
    h1{font-size:24px;margin:0 10px 0 0;display:flex;gap:10px;align-items:center}
    .pill{display:inline-flex;gap:6px;align-items:center;background:#0d1530;border:1px solid var(--line);color:var(--muted);padding:10px 12px;border-radius:999px}
    .controls{display:flex;flex-wrap:wrap;gap:8px;align-items:center}
    input[type="search"], select{ background:#0d1530;border:1px solid var(--line);color:var(--ink);padding:10px 12px;border-radius:12px }
    input[type="search"]{width:230px}
    .grid{margin-top:16px;display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px}
    .card{ background:linear-gradient(180deg,rgba(18,26,51,.9),rgba(12,18,36,.9)); border:1px solid rgba(66,90,150,.45); border-radius:var(--radius); box-shadow:var(--shadow); overflow:hidden; display:flex; flex-direction:column }
    .thumb{ height:120px; display:flex; align-items:center; justify-content:center; background:
      radial-gradient(900px 400px at 70% -20%, rgba(122,162,255,.35), transparent 50%), linear-gradient(135deg, rgba(122,162,255,.08), rgba(0,0,0,.06));
      border-bottom:1px solid rgba(120,150,220,.25) }
    .thumb span{font-size:44px;filter:drop-shadow(0 6px 20px rgba(0,0,0,.45))}
    .body{padding:14px 14px 12px;display:flex;flex-direction:column;gap:10px}
    .title{display:flex;justify-content:space-between;gap:8px}
    .title h3{margin:0;font-size:16px;line-height:1.35}
    .desc{color:var(--muted);min-height:38px}
    .tags{display:flex;flex-wrap:wrap;gap:6px}
    .tag{font-size:12px;color:#c7d2fe;background:rgba(122,162,255,.12);border:1px solid rgba(122,162,255,.25);padding:5px 7px;border-radius:999px}
    .meta{display:flex;justify-content:space-between;color:#8aa1e0;font-size:12px}
    .actions{display:flex;gap:8px;margin-top:6px}
    .actions a{ flex:1; text-align:center; text-decoration:none; color:#fff; background:linear-gradient(180deg,#3b82f6,#2f62c7); border:1px solid #2f4fa2; padding:8px 10px; border-radius:10px }
    .empty{opacity:.7;border:1px dashed #2d3a66;border-radius:16px;padding:18px;text-align:center}
    .divider{height:1px;background:linear-gradient(90deg,transparent,rgba(120,150,220,.35),transparent);margin:16px 0}

    .ph-card{position:relative;z-index:2;max-width:1200px;margin:16px auto;border-radius:16px; border:1px solid var(--ph-border);
      background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,0)); box-shadow:var(--shadow)}
    .ph-inner{display:flex;gap:16px;align-items:center;padding:14px}
    .ph-badge{width:36px;height:36px;display:inline-flex;align-items:center;justify-content:center;border-radius:10px;background:#0f1a3d;border:1px solid var(--ph-border)}
    .ph-title{margin:0 0 2px;font-size:15px;color:#cfe0ff}
    .ph-fact{font-size:clamp(14px,2.2vw,18px);line-height:1.55}
    .ph-actions{display:flex;gap:8px;margin-left:auto;flex-wrap:wrap}
    .ph-btn{appearance:none;border:1px solid var(--ph-border);background:#0e141f;color:var(--ink);padding:8px 12px;border-radius:10px;font-weight:600;cursor:pointer}
    .ph-btn.primary{border-color:rgba(77,163,255,.5);box-shadow:inset 0 0 0 1px rgba(77,163,255,.25)}

    .ph-canvas-wrap{position:relative;margin:18px 0 10px;border:1px solid var(--line);border-radius:16px;overflow:hidden}
    .ph-canvas-wrap canvas{display:block;width:100%;height:42vh;min-height:320px;max-height:640px}
    .ph-controls{position:absolute;left:12px;bottom:12px;display:flex;gap:8px;flex-wrap:wrap;background:rgba(9,13,18,.6);border:1px solid var(--line);padding:10px;border-radius:12px;backdrop-filter:blur(6px) saturate(1.2)}
    .ph-slider{display:flex;align-items:center;gap:8px}
    .ph-slider input[type="range"]{width:160px}
    .date{display:none}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>
        <span style="display:inline-flex;width:28px;height:28px;border-radius:8px;align-items:center;justify-content:center;background:#16234d;border:1px solid #2d3a66">âš›ï¸</span>
        ì‹œ(ë¬¼ë¦¬)ì—ì´ì…˜
        <span class="pill" title="ì´ í”„ë¡œì íŠ¸ ìˆ˜"><span id="count">0</span>ê°œ</span>
      </h1>
      <div class="controls">
        <input id="q" type="search" placeholder="ê²€ìƒ‰: ì œëª©Â·íƒœê·¸" />
        <select id="cat">
          <option value="">ëª¨ë“  ë¶„ë¥˜</option>
          <option>ì‹œë®¬ë ˆì´ì…˜</option>
          <option>ì „ì/ë°˜ë„ì²´</option>
          <option>ê´‘í•™</option>
          <option>ìƒëŒ€ì„±</option>
          <option>ë°ì´í„°ë„êµ¬</option>
          <option>ì›¹ì•±</option>
          <option>ì—´</option>
          <option>ì—­í•™</option>
        </select>
        <select id="sort">
          <option value="updated">ìµœì‹ ìˆœ</option>
          <option value="title">ê°€ë‚˜ë‹¤ìˆœ</option>
          <option value="category">ë¶„ë¥˜ìˆœ</option>
        </select>
      </div>
    </header>

    <div class="divider"></div>

    <section class="ph-card" id="fun-fact" aria-live="polite">
      <div class="ph-inner">
        <span class="ph-badge">ğŸ“</span>
        <div style="flex:1 1 auto">
          <h2 class="ph-title">ì˜¤ëŠ˜ì˜ ë¬¼ë¦¬</h2>
          <div class="ph-fact" id="fact-text">ë¡œë”© ì¤‘â€¦</div>
        </div>
        <div class="ph-actions">
          <button class="ph-btn primary" id="next-fact">ë‹¤ë¥¸ ì‚¬ì‹¤</button>
          <button class="ph-btn" id="copy-fact" title="í´ë¦½ë³´ë“œë¡œ ë³µì‚¬">ë³µì‚¬</button>
          <button class="ph-btn" id="share-fact" title="ê³µìœ ">ê³µìœ </button>
        </div>
      </div>
    </section>

    <section class="ph-canvas-wrap" aria-label="ì¸í„°ë™í‹°ë¸Œ ì¤‘ë ¥ ë°°ê²½">
      <canvas id="gravity-bg"></canvas>
      <div class="ph-controls">
        <button class="ph-btn" id="toggle-run">â¸ï¸ ì¼ì‹œì •ì§€</button>
        <button class="ph-btn" id="toggle-trail">íŠ¸ë ˆì¼: ì¼œì§</button>
        <button class="ph-btn" id="reset">ë¦¬ì…‹</button>
        <div class="ph-slider">
          <label for="particle-count">íŒŒí‹°í´</label>
          <input type="range" id="particle-count" min="50" max="800" step="10" value="260" />
          <span id="particle-label">260</span>
        </div>
      </div>
    </section>

    <main id="grid" class="grid" aria-live="polite"></main>

    <template id="card-tpl">
      <article class="card" tabindex="0" aria-label="í”„ë¡œì íŠ¸ ì¹´ë“œ">
        <div class="thumb"><span>ğŸ§ª</span></div>
        <div class="body">
          <div class="title"><h3></h3></div>
          <p class="desc"></p>
          <div class="curriculum"></div>
          <div class="tags"></div>
          <div class="meta"><span class="category"></span><span class="date"></span></div>
          <div class="actions">
            <a class="demo" target="_blank" rel="noopener">ë¯¸ë¦¬ë³´ê¸°</a>
          </div>
        </div>
      </article>
    </template>

    <p class="empty" id="empty" style="display:none">ê²€ìƒ‰ ì¡°ê±´ì— ë§ëŠ” í”„ë¡œì íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
  </div>

  <script>
  // ===== í”„ë¡œì íŠ¸ ì¹´ë“œ ë Œë”ë§ =====
  const projects = [
    {title:"í† í¬ì™€ í‰í˜•", category:"ì—­í•™", desc:"ë¬¼ì²´ë¥¼ ì´ìš©í•´ í† í¬í‰í˜• ë§Œë“¤ê¸°", tags:["í† í¬","í‰í˜•"], emoji:"ğŸ§—â€â™€ï¸", demo:"./í† í¬ì™€ í‰í˜•.html", curriculumId:"[12ë¬¼ë¦¬01-01]"},
    {title:"RLC ê³µëª…", category:"ì „ì/ë°˜ë„ì²´", desc:"ì§ë ¬ RLC ê³µëª…/ìœ„ìƒÂ·ì „ë¥˜ ë³€í™” ì‹œê°í™”.", tags:["íšŒë¡œ","ê³µëª…"], emoji:"ğŸ”„", demo:"./RLC ê³µëª….html", curriculumId:"[12ì „ì01-06]"},
    {title:"ê°„ì„­ë¬´ëŠ¬", category:"ê´‘í•™", desc:"íŒŒì¥Â·ìŠ¬ë¦¿ ê°„ê²© ì¡°ì ˆë¡œ ê°„ì„­ íŒ¨í„´ ê´€ì°°.", tags:["íŒŒë™","ë¬´ëŠ¬"], emoji:"ğŸ¯", demo:"./ê°„ì„­ë¬´ëŠ¬.html", curriculumId:"[12ë¬¼ë¦¬03-01]"},
    {title:"ê´‘ì „íš¨ê³¼", category:"ì „ì/ë°˜ë„ì²´", desc:"íŒŒì¥/ì„¸ê¸°ì— ë”°ë¥¸ ê´‘ì „ì ë°©ì¶œê³¼ ì„ê³„ ì£¼íŒŒìˆ˜.", tags:["ê´‘ì","ê¸ˆì†"], emoji:"ğŸ“¸", demo:"./ê´‘ì „íš¨ê³¼.html", curriculumId:"[12ì „ì02-04]"},
    {title:"ë‹¤ì´ì˜¤ë“œ", category:"ì „ì/ë°˜ë„ì²´", desc:"PN ì ‘í•©Â·ê³µí•ì¸µÂ·Iâ€“V íŠ¹ì„± ì§ê´€.", tags:["PN","Iâ€“V"], emoji:"ğŸ”Œ", demo:"./ë‹¤ì´ì˜¤ë“œ.html", curriculumId:"[12ë¬¼ë¦¬03-05]"},
    {title:"ë„í”ŒëŸ¬íš¨ê³¼", category:"ê´‘í•™", desc:"ì´ë™ ìŒì›/ê´€ì¸¡ì ì£¼íŒŒìˆ˜ ë³€í™”ì™€ ë§ˆí•˜ ì½˜.", tags:["ë„í”ŒëŸ¬","íŒŒë™"], emoji:"ğŸµ", demo:"./ë„í”ŒëŸ¬íš¨ê³¼.html", curriculumId:"[12ì—­í•™03-03]"},
    {title:"ëŸ¬ë”í¼ë“œ ì•ŒíŒŒì…ì ì‚°ë€ì‹¤í—˜", category:"ì‹œë®¬ë ˆì´ì…˜", desc:"ê¸ˆë°• í†µê³¼Â·ëŒ€ê° ì‚°ë€Â·ë°˜ì‚¬ í™•ë¥  ì‹œê°í™”.", tags:["ì‚°ë€","ì¿¨ë¡±"], emoji:"ğŸ§ª", demo:"./ëŸ¬ë”í¼ë“œ ì•ŒíŒŒì…ì ì‚°ë€ì‹¤í—˜.html", curriculumId:"[12ì „ì01-06]"},
    {title:"ë Œì¦ˆì˜ êµ´ì ˆ", category:"ê´‘í•™", desc:"ë³¼ë¡/ì˜¤ëª©Â·ì‹¤ìƒ/í—ˆìƒ êµ¬ì„±ê³¼ ë³´ì¡°ì„ .", tags:["ë Œì¦ˆ","ìƒ"], emoji:"ğŸ”­", demo:"./ë Œì¦ˆì˜ êµ´ì ˆ.html", curriculumId:"[12ë¬¼ë¦¬03-02]"},
    {title:"ë°œê´‘ ë‹¤ì´ì˜¤ë“œ", category:"ì „ì/ë°˜ë„ì²´", desc:"íŒŒì¥ë³„ ì „ì••Â·ë°´ë“œê°­ê³¼ ë°œê´‘.", tags:["LED","ë°´ë“œê°­"], emoji:"ğŸ’¡", demo:"./ë°œê´‘ ë‹¤ì´ì˜¤ë“œ.html", curriculumId:"[12ì „ì02-04]"},
    {title:"ìƒëŒ€ì„±ì´ë¡ ", category:"ìƒëŒ€ì„±", desc:"ê¸¸ì´ìˆ˜ì¶•Â·ì‹œê³µê°„ ì‹œê°í™”(ìš°ì£¼ì„ /ë³„).", tags:["íŠ¹ìˆ˜","ì¼ë°˜"], emoji:"ğŸš€", demo:"./ìƒëŒ€ì„±ì´ë¡ .html", curriculumId:"[12ë¬¼ë¦¬03-06]"},
    {title:"ìŠ¤ë„¬ì˜ ë²•ì¹™", category:"ê´‘í•™", desc:"êµ´ì ˆë¥  ë³€í™”ì— ë”°ë¥¸ ì…ì‚¬/êµ´ì ˆ/ì„ê³„ê°.", tags:["n1,n2","TIR"], emoji:"ğŸ“", demo:"./ìŠ¤ë„¬ì˜ ë²•ì¹™.html", curriculumId:"[12ë¬¼ë¦¬03-02]"},
    {title:"í¬ë¬¼ì„  ìš´ë™", category:"ì—­í•™", desc:"ëŒ€í¬ë¥¼ ì´ì„œ ê³¼ë…ì„ ë§ì¶”ì.", tags:["í¬ë¬¼ì„ ìš´ë™","ê²Œì„"], emoji:"ğŸŒˆ", demo:"./í¬ë¬¼ì„  ìš´ë™.html", curriculumId:"[12ì—­í•™01-02]"},
    {title:"ì—´ì—­í•™", category:"ì—´", desc:"ë“±ì••, ë“±ì , ë“±ì˜¨, ë‹¨ì—´ê³¼ì •ì„ í™•ì¸.", tags:["ì—´ê¸°ê´€","ì—´ê³¼ì •"], emoji:"ğŸ¦â€ğŸ”¥", demo:"./ì—´ì—­í•™.html", curriculumId:"[12ë¬¼ë¦¬01-06], [12ì—­í•™02-02]"},
    {title:"ì˜´ì˜ ë²•ì¹™", category:"ì „ì/ë°˜ë„ì²´", desc:"V=IR, ì§ë ¬/ë³‘ë ¬ ì§ê´€, ì „ë¥˜ íë¦„ ì• ë‹ˆë©”ì´ì…˜.", tags:["ì „ì••","ì „ë¥˜"], emoji:"âš¡", demo:"./ì˜´ì˜ ë²•ì¹™.html", curriculumId:"[12ë¬¼ë¦¬02-02]"},
    {title:"ì›ìëª¨í˜•", category:"ì‹œë®¬ë ˆì´ì…˜", desc:"ë³´ì–´/ì˜¤ë¹„íƒˆ/ì „ìêµ¬ë¦„ ê°œë… ì‹œê°í™”.", tags:["ì›ì","ì¤€ìœ„"], emoji:"ğŸ§¬", demo:"./ì›ìëª¨í˜•.html", curriculumId:"[12ì „ì03-04]"},
    {title:"ì´ì¤‘ìŠ¬ë¦¿", category:"ê´‘í•™", desc:"í™•ë¥ íŒŒë™Â·ê°„ì„­ë¬´ëŠ¬Â·íŒŒë¼ë¯¸í„° ì¡°ì ˆ.", tags:["ìŠ¬ë¦¿","ê°„ì„­"], emoji:"ã€°ï¸", demo:"./ì´ì¤‘ìŠ¬ë¦¿.html", curriculumId:"[12ì „ì03-01]"},
  ];

  const grid = document.getElementById('grid');
  const q = document.getElementById('q');
  const cat = document.getElementById('cat');
  const sortSel = document.getElementById('sort');
  const count = document.getElementById('count');
  const empty = document.getElementById('empty');

  function makeCard(p){
    const node = document.getElementById('card-tpl').content.firstElementChild.cloneNode(true);
    const $ = s => node.querySelector(s);
    $('.thumb span').textContent = p.emoji || pickEmoji(p.category);
    $('h3').textContent = p.title;
    $('.desc').textContent = p.desc || '';
    $('.category').textContent = p.category;
    node.querySelector('.curriculum').textContent = p.curriculumId ? `êµìœ¡ê³¼ì •: ${p.curriculumId}` : '';
    const tags = node.querySelector('.tags'); tags.innerHTML='';
    (p.tags||[]).forEach(t=>{ const chip=document.createElement('span'); chip.className='tag'; chip.textContent=t; tags.append(chip); });
    node.querySelector('.demo').href = p.demo || '#';
    return node;
  }

  function pickEmoji(cat){
    return ({'ì‹œë®¬ë ˆì´ì…˜':'ğŸ§ª','ì „ì/ë°˜ë„ì²´':'ğŸ”Œ','ê´‘í•™':'ğŸ”¬','ìƒëŒ€ì„±':'ğŸ›°ï¸','ë°ì´í„°ë„êµ¬':'ğŸ“Š','ì›¹ì•±':'ğŸ§©','ì—´':'ğŸŒ¡ï¸','ì—­í•™':'âš™ï¸'})[cat] || 'ğŸ§©';
  }

  function render(){
    grid.innerHTML = '';
    let list = [...projects];
    const term = q.value.trim().toLowerCase();
    if(term){ list = list.filter(p=> (p.title+p.desc+p.category+(p.tags||[]).join(',')).toLowerCase().includes(term)); }
    if(cat.value){ list = list.filter(p=> p.category===cat.value); }
    const by = sortSel.value;
    list.sort((a,b)=>{
      if(by==='title') return a.title.localeCompare(b.title,'ko');
      if(by==='category') return a.category.localeCompare(b.category,'ko') || a.title.localeCompare(b.title,'ko');
      return (b.updated||'').localeCompare(a.updated||'');
    });
    count.textContent = list.length;
    empty.style.display = list.length? 'none':'block';
    for(const p of list){ grid.append(makeCard(p)); }
  }
  q.addEventListener('input', render);
  cat.addEventListener('change', render);
  sortSel.addEventListener('change', render);
  render();

  // ===== ì˜¤ëŠ˜ì˜ ë¬¼ë¦¬ (ì¶•ì•½) =====
  (function(){
    const FACTS=[
      "íƒœì–‘ë¹›ì´ ì§€êµ¬ê¹Œì§€ â‰ˆ 499ì´ˆ.","ê³µê¸° 343 m/s, ê°•ì² ì€ 10ë°°+.","ì§„ê³µì—ì„  ê¹ƒí„¸ë„ ì‡³ë©ì´ë„ ê°™ì€ ê°€ì†ë„.",
      "c â‰ˆ 2.998Ã—10^8 m/s(ì§„ê³µ).","ì „ì: íŒŒë™ì„±+ì…ìì„±(ì´ì¤‘ìŠ¬ë¦¿).","1eV = 1.602Ã—10â»Â¹â¹ J.",
      "gëŠ” ìœ„ë„/ê³ ë„ì— ë”°ë¼ ì•½ê°„ ë‹¬ë¼ì§.","ì„ê³„ì˜¨ë„ ì´í•˜ ì´ˆì „ë„ì²´: ì €í•­ 0.","IRì€ ê¸¸ê³ , UVëŠ” ì§§ë‹¤."
    ];
    const factEl=document.getElementById('fact-text');
    const nextBtn=document.getElementById('next-fact');
    const copyBtn=document.getElementById('copy-fact');
    const shareBtn=document.getElementById('share-fact');
    let last=-1;
    function pick(){ let i=Math.floor(Math.random()*FACTS.length); if(i===last) i=(i+1)%FACTS.length; last=i; return FACTS[i]; }
    function next(){ factEl.textContent=pick(); }
    nextBtn.addEventListener('click', next);
    copyBtn.addEventListener('click', async ()=>{ try{ await navigator.clipboard.writeText(factEl.textContent.trim()); copyBtn.textContent='ë³µì‚¬ë¨!'; setTimeout(()=>copyBtn.textContent='ë³µì‚¬',900);}catch(e){ alert('ë³µì‚¬ ì‹¤íŒ¨: '+e.message); } });
    shareBtn.addEventListener('click', async ()=>{ const text=factEl.textContent.trim(); if(navigator.share){ try{ await navigator.share({title:'ì˜¤ëŠ˜ì˜ ë¬¼ë¦¬', text}); }catch{} } else { alert('ê³µìœ  ë¯¸ì§€ì› â€” ë³µì‚¬ ì‚¬ìš©'); } });
    next();
  })();

  // ===== ì¸í„°ë™í‹°ë¸Œ ì¤‘ë ¥ ë°°ê²½ (ëˆ„ë¥´ê³  ìˆëŠ” ë™ì•ˆë§Œ ëŒë¦¼) =====
  (function(){
    const canvas=document.getElementById('gravity-bg');
    const ctx=canvas.getContext('2d');
    const dpr=Math.min(window.devicePixelRatio||1,2);
    let W=0,H=0;
    new ResizeObserver(()=>{
      const r=canvas.getBoundingClientRect();
      W=r.width|0; H=r.height|0;
      canvas.width=(W*dpr)|0; canvas.height=(H*dpr)|0;
      ctx.setTransform(dpr,0,0,dpr,0,0);
    }).observe(canvas);

    let PARTICLE_COUNT=260;
    const particles=[];
    function resetParticles(){
      particles.length=0;
      for(let i=0;i<PARTICLE_COUNT;i++){
        particles.push({ x:Math.random()*W, y:Math.random()*H, vx:(Math.random()-.5)*.5, vy:(Math.random()-.5)*.5, m:1+Math.random()*1 });
      }
    }

    const runBtn=document.getElementById('toggle-run');
    const trailBtn=document.getElementById('toggle-trail');
    const resetBtn=document.getElementById('reset');
    const slider=document.getElementById('particle-count');
    const label=document.getElementById('particle-label');
    let running=true, trails=true, pointerActive=false;

    runBtn.addEventListener('click',()=>{ running=!running; runBtn.textContent= running? 'â¸ï¸ ì¼ì‹œì •ì§€':'â–¶ ì¬ìƒ'; });
    trailBtn.addEventListener('click',()=>{ trails=!trails; trailBtn.textContent='íŠ¸ë ˆì¼: '+(trails?'ì¼œì§':'êº¼ì§'); });
    resetBtn.addEventListener('click',()=>{ points.length=0; cursorPoint=null; resetParticles(); });
    slider.addEventListener('input',()=>{ PARTICLE_COUNT=+slider.value; label.textContent=PARTICLE_COUNT; resetParticles(); });

    function pos(ev){
      const r=canvas.getBoundingClientRect();
      const x=(ev.touches? ev.touches[0].clientX:ev.clientX)-r.left;
      const y=(ev.touches? ev.touches[0].clientY:ev.clientY)-r.top;
      return {x,y};
    }

    const points=[];
    let cursorPoint=null;
    function start(x,y){ pointerActive=true; cursorPoint={x,y,m:240}; points[0]=cursorPoint; }
    function move(x,y){ if(pointerActive && cursorPoint){ cursorPoint.x=x; cursorPoint.y=y; } }
    function end(){ pointerActive=false; cursorPoint=null; points.length=0; }

    canvas.addEventListener('pointerdown', e=>{ const p=pos(e); start(p.x,p.y); }, {passive:true});
    canvas.addEventListener('pointermove', e=>{ if(pointerActive){ const p=pos(e); move(p.x,p.y);} }, {passive:true});
    canvas.addEventListener('pointerup', end, {passive:true});
    canvas.addEventListener('pointercancel', end, {passive:true});
    canvas.addEventListener('mouseleave', end);

    canvas.addEventListener('touchstart', e=>{ const p=pos(e); start(p.x,p.y); }, {passive:true});
    canvas.addEventListener('touchmove',  e=>{ if(pointerActive){ const p=pos(e); move(p.x,p.y);} }, {passive:true});
    canvas.addEventListener('touchend', end, {passive:true});
    canvas.addEventListener('touchcancel', end, {passive:true});

    const G=120, FRICTION=0.995, MAX_SPEED=3.6;
    function step(dt){
      for(const a of particles){
        let ax=0, ay=0;
        for(const p of points){
          let dx=p.x-a.x, dy=p.y-a.y;
          let r2=dx*dx+dy*dy;
          r2=Math.max(36, Math.min(r2, 50000));
          const invr=1/Math.sqrt(r2);
          const force=(G*p.m*a.m)/r2;
          ax+=force*dx*invr*0.0015; ay+=force*dy*invr*0.0015;
        }
        a.vx=(a.vx+ax*dt)*FRICTION; a.vy=(a.vy+ay*dt)*FRICTION;
        const sp=Math.hypot(a.vx,a.vy); if(sp>MAX_SPEED){ a.vx*=MAX_SPEED/sp; a.vy*=MAX_SPEED/sp; }
        a.x+=a.vx*dt*60/1000*16; a.y+=a.vy*dt*60/1000*16;
        if(a.x<0){a.x=0;a.vx*=-.8} if(a.x>W){a.x=W;a.vx*=-.8}
        if(a.y<0){a.y=0;a.vy*=-.8} if(a.y>H){a.y=H;a.vy*=-.8}
      }
    }
    function draw(){
      if(!trails){ ctx.clearRect(0,0,W,H);} else { ctx.fillStyle='rgba(11,16,32,0.12)'; ctx.fillRect(0,0,W,H); }
      for(const p of points){
        const grd=ctx.createRadialGradient(p.x,p.y,0,p.x,p.y,28);
        grd.addColorStop(0,'rgba(107,230,117,0.9)'); grd.addColorStop(1,'rgba(107,230,117,0)');
        ctx.fillStyle=grd; ctx.beginPath(); ctx.arc(p.x,p.y,28,0,Math.PI*2); ctx.fill();
        ctx.strokeStyle='rgba(107,230,117,0.35)'; ctx.lineWidth=1; ctx.stroke();
      }
      ctx.beginPath();
      for(const a of particles){ ctx.moveTo(a.x+1.5,a.y); ctx.arc(a.x,a.y,1.5,0,Math.PI*2); }
      ctx.fillStyle='rgba(200,220,240,0.9)'; ctx.fill();
    }

    let last=performance.now();
    function loop(now){ const dt=Math.min(32, now-last); last=now; if(running){ step(dt); draw(); } requestAnimationFrame(loop); }
    if(canvas.getBoundingClientRect().width===0) canvas.style.width='100%';
    resetParticles();
    requestAnimationFrame(loop);
    new ResizeObserver(()=>{ resetParticles(); }).observe(canvas);
  })();
  </script>
</body>
</html>
